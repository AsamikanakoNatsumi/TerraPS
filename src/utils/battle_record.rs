use aes::cipher::{block_padding::NoPadding, BlockDecryptMut, KeyIvInit};
use anyhow::Result;
use serde_json::Value;

use super::crypto::md5::md5_digest;

const DEFAULT_LOGIN_TIME: u32 = 1672502400;
const LOG_TOKEN_KEY: &str = "pM6Umv*^hVQuB6t&";

type Aes128CbcDec = cbc::Decryptor<aes::Aes128>;

pub struct BattleRecordEncoder {
    login_time: u32,
}

impl Default for BattleRecordEncoder {
    fn default() -> Self {
        Self {
            login_time: DEFAULT_LOGIN_TIME,
        }
    }
}

impl BattleRecordEncoder {
    pub fn new() -> Self {
        Self::default()
    }

    pub fn login_time(mut self, login_time: u32) -> Self {
        self.login_time = login_time;
        self
    }

    pub fn decrypt_battle_record(&self, mut record: String) -> Result<Value> {
        let data = hex::decode(record.drain(..record.len() - 32))?;
        let mut src = LOG_TOKEN_KEY.to_string();
        src.push_str(&self.login_time.to_string());
        let key = md5_digest(src.as_bytes()).to_vec();
        let iv = hex::decode(record)?;
        let aes = Aes128CbcDec::new(key.as_slice().try_into()?, iv.as_slice().try_into()?);
        let res = aes.decrypt_padded_vec_mut::<NoPadding>(data.as_slice().try_into()?)?;
        let json_string = String::from_utf8(res)?;
        Ok(serde_json::from_str(json_string.trim())?)
    }
}

#[cfg(test)]
mod tests {
    use serde_json::Value;

    use crate::utils::battle_record::BattleRecordEncoder;

    const TEST_DATA: &str = r#"{"battleData":{"completeTime":124,"isCheat":"aGlqa2xtbm80ODk6OzQ8PT4/NGg4aTlqOms7bDxtPQ==","stats":{"access":"D0FFEC8997C8DF41D82ED69415936C0A","autoReplayCancelled":0,"beginTs":1712277102,"charAdvancedStats":{},"charList":{},"charStats":[],"checkKilledCnt":1,"clientAntiCheatLog":{},"endTs":1712277409,"enemyAdvancedStats":{},"enemyList":{"enemy_5028_dqlime_2":[[1390.0,435.0,0.0,0.0,100.0,3.3,1.0]],"enemy_5029_dqslim":[[600.0,75.0,0.0,0.0,100.0,2.0,0.8]],"enemy_5030_dqpro_3":[[1500.0,555.0,0.0,20.0,100.0,1.4,1.9]],"enemy_5031_dqrtar_2":[[2500.0,825.0,150.0,0.0,100.0,4.5,0.8]],"enemy_5032_dqmon":[[3750.0,900.0,230.0,50.0,100.0,2.0,0.85]],"enemy_5033_dqmstr_2":[[5500.0,975.0,200.0,30.0,100.0,3.0,0.65]],"enemy_5034_dqield":[[3000.0,900.0,800.0,0.0,100.0,2.6,0.75]],"enemy_5035_dqveng_2":[[9000.0,720.0,230.0,50.0,100.0,2.3,0.65]],"enemy_5036_dqger_2":[[15000.0,2625.0,230.0,30.0,100.0,1.3,1.2]],"enemy_5037_dqdbox":[[4000.0,450.0,300.0,0.0,100.0,1.2,1.6]],"enemy_5038_dqiprr_2":[[3500.0,480.0,80.0,30.0,100.0,3.0,0.9]],"enemy_5039_dqgint":[[50000.0,4500.0,700.0,30.0,100.0,7.0,0.4]],"enemy_5040_dqmage":[[3500.0,900.0,160.0,65.0,100.0,7.0,0.6]],"enemy_5041_dqkght":[[1400.0,450.0,100.0,0.0,100.0,2.4,0.9]],"enemy_5042_dqkght_2":[[6500.0,975.0,800.0,0.0,100.0,2.3,0.7]],"enemy_5043_dqgscr":[[2500.0,375.0,200.0,50.0,100.0,4.5,0.7]],"enemy_5044_dqzeni":[[3000.0,450.0,200.0,10.0,100.0,2.5,0.9]],"enemy_5045_dqjedi_2":[[7000.0,1200.0,650.0,50.0,100.0,3.0,0.75]],"enemy_5046_dqmir":[[5000.0,600.0,200.0,40.0,100.0,2.5,0.8]],"enemy_5047_dqripr":[[2750.0,480.0,380.0,10.0,100.0,1.0,0.8]],"enemy_5048_dqingd":[[12500.0,600.0,300.0,10.0,100.0,4.0,0.6]],"enemy_5049_dqat":[[12500.0,1800.0,100.0,40.0,100.0,4.0,0.7]],"enemy_5050_dqomg":[[1500.0,1020.0,200.0,20.0,100.0,4.0,0.7]],"enemy_5051_dqrwar":[[2000.0,480.0,250.0,50.0,100.0,0.4,0.95]],"enemy_5052_dqsbr":[[2000.0,600.0,200.0,0.0,100.0,1.5,1.0]],"enemy_5053_dqllme":[[20000.0,345.0,220.0,70.0,100.0,3.5,0.65]],"enemy_5055_dqkill":[[12500.0,1050.0,400.0,20.0,100.0,4.0,0.6]]},"enemyStats":[{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5047_dqripr","isInvalidKilled":0},"Value":17},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5048_dqingd","isInvalidKilled":0},"Value":10},{"Key":{"counterType":"HP_ZERO","enemyId":"enemy_5047_dqripr","isInvalidKilled":0},"Value":17},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5029_dqslim","isInvalidKilled":0},"Value":23},{"Key":{"counterType":"HP_ZERO","enemyId":"enemy_5029_dqslim","isInvalidKilled":0},"Value":23},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5037_dqdbox","isInvalidKilled":0},"Value":14},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5031_dqrtar_2","isInvalidKilled":0},"Value":8},{"Key":{"counterType":"HP_ZERO","enemyId":"enemy_5037_dqdbox","isInvalidKilled":0},"Value":6},{"Key":{"counterType":"HP_ZERO","enemyId":"enemy_5031_dqrtar_2","isInvalidKilled":0},"Value":4},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5030_dqpro_3","isInvalidKilled":0},"Value":100},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5044_dqzeni","isInvalidKilled":0},"Value":14},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5035_dqveng_2","isInvalidKilled":0},"Value":4},{"Key":{"counterType":"HP_ZERO","enemyId":"enemy_5030_dqpro_3","isInvalidKilled":0},"Value":90},{"Key":{"counterType":"HP_ZERO","enemyId":"enemy_5044_dqzeni","isInvalidKilled":0},"Value":14},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5028_dqlime_2","isInvalidKilled":0},"Value":23},{"Key":{"counterType":"HP_ZERO","enemyId":"enemy_5028_dqlime_2","isInvalidKilled":0},"Value":23},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5053_dqllme","isInvalidKilled":0},"Value":2},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5049_dqat","isInvalidKilled":0},"Value":3},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5052_dqsbr","isInvalidKilled":0},"Value":14},{"Key":{"counterType":"HP_ZERO","enemyId":"enemy_5052_dqsbr","isInvalidKilled":0},"Value":14},{"Key":{"counterType":"HP_ZERO","enemyId":"enemy_5049_dqat","isInvalidKilled":0},"Value":2},{"Key":{"counterType":"ENCOUNTER","enemyId":"enemy_5050_dqomg","isInvalidKilled":0},"Value":2},{"Key":{"counterType":"HP_ZERO","enemyId":"enemy_5050_dqomg","isInvalidKilled":0},"Value":1}],"extraBattleInfo":{"DETAILED,player,0,win":1,"DETAILED,player,1,win":1,"DETAILED,player,2,win":1,"DETAILED,player,3,win":1,"DETAILED,player,4,win":1,"SIMPLE,act5fun_npc_01,win":5,"SIMPLE,act5fun_npc_02,lose":2,"SIMPLE,act5fun_npc_02,win":3,"SIMPLE,act5fun_npc_09,lose":2,"SIMPLE,act5fun_npc_09,win":3,"SIMPLE,act5fun_npc_10,lose":3,"SIMPLE,act5fun_npc_10,win":2,"SIMPLE,act5fun_npc_13,lose":2,"SIMPLE,act5fun_npc_13,win":3},"extraBattleInfoStats":{},"extraBattleInfoSubStats":[],"extraInfo":{"100":"id=1|seq=47|pid=1610|time=1712277401","8":"id=8|name=NeteaseX86"},"fixedPlayTime":250899,"hash":"62AE221E4C5D4CAD4B851D7380F4ED2C","idList":[],"killedEnemiesCnt":213,"leftHp":15,"packageName":"com.hypergryph.arknights","packedRuneDataList":null,"rlBuffAdvancedStats":[],"rlBuffList":[],"runeAdvancedStats":[],"runeList":[["enemy_attribute_mul",1023,3,[{"key":"atk","value":1.5,"valueStr":null},{"key":"max_hp","value":0.5,"valueStr":null}]]],"skillTrigStats":[],"totalDamage":187664.531,"totalHeal":0.0,"unnatrualRecoveredCost":0}},"battleId":"abcdefgh-1234-5678-a1b2c3d4e5f6","completeState":1,"currentIndex":0,"giveUp":0,"interrupt":1,"killCnt":213,"percent":41,"platform":1,"validKillCnt":193}"#;

    #[test]
    fn test_battle_record_decryption() {
        let encoder = BattleRecordEncoder::new();
        let data = encoder.decrypt_battle_record("61A7026E285F7087C26CF1948AF414D1F549D72CAB1E1C485CFB81397C18B2C1631B6228521FCFEBF852D058811A8EFFA694F182B0343041DC80C8C3947E438C55370E722C1EE45967EF8062E8EC02619E4165FFE78938D3C818771051845DDC0AA36D3BD391E6845BE4043B32F4F7822DAA17A55D22B73CF0306369CD1BA7359DF13D87107350290AF98DFFA8F691146706BC7D84D8CB1DBD2AD7167ED72DD764FB2EF0B886DAEAA8A14367B9F3489F3F5194EE2D05D5923E0978E4955FD4804F8639CE5213D30121309EFDD98D45C1D6DAD1209D52B741A85252220938C5767B411FBC8D28423C4DA32CEE134C5AEF5AE3683BAC0799DCFD328DE651CFE815A90B58FC2CC7AB0D47353460E0A56C5210C7BBB56F12E4AD225DE18D5209F3F00604F31AF3C7CB4FF0E46364819C4CBBC39F8157F9B79FCF30CBEF3786549EDA526334BB86D61B3B5B6FDA293B0FD790CE407CFA0DD69ECC4042C5FDBF3E36782219418FA89516C8289EC64E3DDD2868028FF5B39B03B06B3AFC1D8ABC9F08121DD1838743CC59BCA768FF4C00768D99A1F6B00DA56EEE428B5859F427E29834E4A0673C78B34727B08EA79D14BA9F7B801F14F1025E4ECFCE853C1D57189D97C2377538613C23F87E5319C6C1B921DFD859FA97FE8A0AD5BAA4D5FD3C8FBB65122FBB61FACC80B24AD87D0DA7C77C7D749DA80ADCEFC785CA4819341A62F952E583F9BF57FB6D9A738D2A0712ADFC869C25FB03B5676F339E5CD036D5B3E54DB6AFFA0FB72C3FD3EF5B7B56464F7CD9B64E31A2E5F511E56674D8A56FEE4965D698C5D3833826234617F616957254E07D0E4359D6D83D86CD2D1C992A598AA6BB22B87DFB0D1D97FD7A72CA4DD027E5DED2FFC016F8C480C80B0A3C0A763D58212F16C7D9D32463D7F0A6396046A7B9EE8317162B88BCDD86A99DF48838D6A8532489BCF51564975398D3FA50F27D14F69D93B6A8759523EAAAB244504F649A774F09F8C8839B0102BCD75BB56FAE10A7BFDB9ECF748284E79908F17B33095A81A5C609DD9137302D44889378513443BAC0FC041CBBE288F6D84D8828FCAF10F8E1BF8F342A4BA4F764AFB87863957C2313214769B116DCDDF13E116E0DA63F93D73E3BF631E88EE3AAEB7A6044CAD206CE6D70D960D25C3CC9F5F27768B6CF6A9BD60CF90E7D2182E00A4624B9589B0E206D59512086EA910674061591D83ABA9899AEB1280FB365753488BFF70C0B7E088EAE73B0354EC37E17AA4A1A787297B15378CEF805B3AE544939EA15B8C0AC93A77ADE978D83497633E8AF711B801D3DBD156D7259A82DAB591298DE9D544BF48CE5D23B0AD68E2B4A35961A2226136A3998CF576C8A30D00BF3B4C93CBEF8558B84B9B75A4125ED7C5DE5C0FC9578B73A5AB3C0994226402126C617B502FD78F86DE1FA7DBF63C6924D910493087D4109750FA2EA60A9BC68D6E5861FD4FB77E6C9ED76768E180435D134CFB996A75A264D52858E41E17BCD548DEEBE6B8B8E1B594C1B3F70E4DFF9045AFE5DB4F14946B91B0BDBDD457B4DB2D04F320094D963229C79E89F0020D1AB60998A5947044E5A947D62C6F31BAD2B9F4BED9F628E14081A070A9C4B7F327F21FA601E3334BD91E7CA2BD4D887BEABB048BA98101553A00CB78101F0D46EF6D75F1C185E24E2D134A113ED7316243C037EEA04054EDB8329DB3A365E5F656069CD48AB544D9BF8ED7511F485F39E817D6088B0962C0537748C02C686B3760C9E48709A65422DED975050278A52CB932AADB924B0092A25B8F314E66FCED8F964DA75B731E3C104C79A5DD6F366F7A0007585353E236B5D616879786B11728B3862BA6CFB0FC01A16187913338578EFE08B2ECD319A16001D04C90D60E7FB82AA78DFD340D0D2BA4F53B3E4677954FBC15F7F68FE31B8F4774D5712143E296F9908BE0D128F29B3F6F17235CFB1BF1030A6B6527257F972807840E422BA87088719988EEC1A53A89D7BA3E90E352E9DF03E34C17F8482A8C6FBF56A6154174C5546D053819425BA096B3C2785009D938F0B5A7D0D458CD6BABDE3B6E686806512153B559D48624568651275AAE74F6F6E82979D773F3B56A53780DB4B015A267EAF1ED00566291BC9A7F422B1C5B91D8AA20A38EBF9C92C14DC29BC6ACCAFB50286AB65EAAB5F1899D6AC78ED2567B653FC5C5D0949133E42D99AB17183F051EAF7FD1880D1D173F71384AED83A227FBBC940AD5600133F63F970F832866BB84BCC23AEBA3E8CE6A4B1B3BE251645E0EBC701FDE8DC76B337CDB2F0FBD1203AB0F0D8DCEFF20C041139A430F151F005893986DCA85696BC0DF5F132BA43DA0AE2C4FC56E13506066AE68375697AC1B3C6B7D32F7FBE51AC13CBD3983392BACAD7BCFD317604C150C6A90E314D0AC842886B8A071C27FCFDE639F3CC479934E19FF0D9F2125F2A6129B60CF1BAA83B0C733C0DE15E2FDFA672743F67486B163AEA20C8B24BE30DA1CC81C3FE858E0B18A8D60743A269EED79B55635D532FB47D36D8C61985D10475F64AC58796A216CE329B714EBAB8054AC72208CA95EF927EC0A1BBD004BD37578766489FF6CBEAECDE4FD86C49FE512D9971613A402496351D4809F42CD39A9AC884B02B0DFC0438CE79A23467E99C88353DC9CA5786C6C07F3128953C6D78F7D6D9599F335A3076134303AADB5FE1D3B9F41DC4EDBDA442EA941F4DF799C343874134B02D7E1130924F5AEB91F4856A9836F2F722D1464D3E2BECE733D7381688DB20D29D957E72BD116D4829ABB597BCFBC960EA9F897FA95989EFD9DB404DC9DB13D4CA88D397787150329FE9F19F0D0BA58EF299FD1965E0C14BBA19CD0C33093EF353E27A281050E29050039D1DDB6F64DC3666C11105D5A7B6F8046E36899E357E5FA5E76FF3C0EAD5EF15D244520A815DA5910C15F93D33A9F307130C1C1BD7EA2E0DE52523DE6B8455F59E381A3874E8C9CD9798E9EB0FA782D64879DA181C97E9ECF115101F81F27625BEEF03C29A682D371D8F09EF5D7CEB1A4A6527E5F3E75143F39573B98809A134510DF5B9B258EBD448D2EFE219C2230045DB574EB87182ABBC47A0BB966295F2F284490A554DB80D48A83ED227A691A543DA30DDD725C7A6124C8DFA8302AA22919830A76647663E7417539E5F32DEA7F9CA0CFF295CED9022480C4C742910B752B75E0D1BB3084898A32B7F8F743E1209202F402630C7DFB6D8A53EDDF501503ACDE4F1B553973B6A77CF77B3233840A5753D5B12A398E1385042F09BAD880008CAEDD6C9A5B2B8325777A8314D599E3DD2ECEB21A73D9BCB058C29E84B927040C3C42B52991AA0DF5DBEB99E91FD264F1F7A45DBD5288EC30D5CAAF91D11F10948AF481CA52721855108BCE5EC082C8CBF3DA952001802B44EB27422FA43C7C231E57B9E1237EE6702A26F7CC21F01D43AC6087CB415760BBD5A28D5F1AB2B850963AB349D7D6AB3087F078F450379C7A2DB8C17E3361BE967E089EC456CC4FC3D99D922D9B53C607C8C94B970A1BC2D1C6C7A93018E4256F6F8BC12C37BD73D1646E72F9C75283D478C6AF37EF349FCDA3925CA44A22C06D414F902F5BD8392C2436FA2792527D6E6201AF60D2FEA00DDA51E312E5A6AE43A0677C1387CF88F26F17099217307DC3E9BC1426988284F1F0349F513AFA32245E9A6CCF7E905F285482E843C5CCA1279D8CCA1546802DC84037507971950794F876595DD7D0803BF51A997D80DFDC7CEF06901D54691A44BAD536D437CB0C0D4AB33A377D2CE0A2710332FFC9AECF7A29CCE21641FE0849D565B923BF6EC293232616BACA82B1C8B7267954AD39B0F200F0986138940C017AFF1B7598F304443F66ACEC7D61E588DAE953CD955D914A6597D299DADC58DC18BF3FE6F4B6293DFF3F19DDE5C0AD201FB51CD950A04D0BF7EAC4288EA22487852EB0794CEAEFD09460AEFF3C64EE9F2452679388FFFE40A2C826763E5691606D76C904FFFD1AB8DF0F84B6A45C84CDDBDF1B1C641FE235BE71BDECF4B368D33CE65E521911A7EFBB5889B8AFBA0535B3B7AC45E9B62376A1AEA246A4F04083ADC2AD4FFC8B78D3B22BA7474971BDAEF069744F52A85C7F41A27DF994A2E3B36935AC76F0920940C5413834CF241C9DADE30D2AC5EE58CAD61E9322BCE3AF1FC9BD47D51D16F21B40E5B52E2E74B074E42616668042151113E95FC002AF89D3E69A83798E3D064514A8821B76E1E7B8F63341A00AEDAD7D8B19F9DE3FACF3EB8EEC5E77242DC88027FD416DE3EA0A0ACC9A121B5216C686C65B2A363848614E1CCB1DDBA9DB8052264686F297DF9DBAFDB1AE97357B2613AC7C4325464925AAC7672A4244C61B26A3F778FA7FF7357C7D39477B7B5BD8D36BCA8E7DAD0672AE249C597241A8B28AD8DD51F75AE44F90D9027ADDA73A8C9AF4852B9B36AB3F226D12CFC5D1831D6A038263AD02D9C048E4EF579C0EC01BBFB4A0D5839C77FFE69B6CF3595655D2EE0F25F340E02979C7C6A7DBCEAEA53BF2695AA6939AFF131C94745FCEA55FC6EEE810627412FFFDE10561E0C6E7954CCAF20A247E463FBAD15B25371D5102CC8A0425E4448351E2AC858270189ADB37FC40A3BE8AA38F4D226CB398B8003F40C47BF4C9D9AE474F713996B35113EF4B3912F249B42CB243031611C91DA7478858C95625444E04F7F0E36F52D3225547D5DC6D066414C3397B8A1EDBC5B1F7F68FFCF944E905983DF1CCA96784E11FB81A9743D5AE08533DBC7A2EF1A795E11D203350432ACC4BDB34B1353E49F84A92362F9260A68CBC0D5A0FBA1FABF6E5C4985ECF33EA56D5C3C35B4DC5D17750F162E13F5DC9B3D317EC4FB37BF48CD825255F801429EF3A0900F31BDEBB97CAE0F52BB09D16F80310D40C041EAF08286D73D5755A9FDC9E69B40F093D96D4E70A3F3F896C4C926C1CCFFE6C1F813E93B1FAC79C38DDCF75CCA80358D7241CEE735C631916162CEB6D8A436AE38844B244D29BE6773BF3216C10675F3036A8867D728EBB6BA8F71096FC86A9804533D0F7510775AB29A0B36126FF3A9DB11893A5C4117C56B2BD59DF7B401DEEDA2774A96526A523588E1F16042B0F4428B7B5880062ABCCB3D174F6E93E7BE51FA7B618F1154B5221501CE6C07E84D851AEE9A6628D230930DA8547769CEED40C282ADCF39E019CBD01028E31CD9BD1B7069711F46BCDBB2ACAFCDB4AFAA77A0AE5BEF59B8E516938AE1E90AB59EA74C65F65AB5B26F035DF448F66B3F34AC15DDE1D0C6F274B852E56B92CC1CA6AF260C376D09C81FD9F5D5B695D23FCC2D997AAB4AD7B791F137C7396CCE757918DBDAAD1A72EF3C3D40AD4D5BD6DA59B6F8CF55418B5454E660A6EC8A901DC7B5145EBA2497A34FF2398866BF196FDB80067F5BC9453F8814CFC98A740214FDBCE65241DA76059D4F5388A590A6FB16A73FAD7779F960CE75F509782E5E51B4E91415B6E8BEAA670008498AA7E16A7BFA79BA9FD1213524A24E9BEF9F8CBBFE10556F448467132CB282099F8180BFF66359185E2FFCDA14B4B305E73FA2834D9C0719C18BBFECA434D1F0EC559475F7419661EBECB594D34AA5F98CCC6C8DDCCD52BF70F86B89D413D06B8C2968B3D72D2BDE582AFEAE4B30726C8DE3A92F4E7BFEC386EB4FFB136161EE2A30E820DD68959C7C2B21E3F9CF4A3FE1865E09099E79B1BD1BF40F9230E021D6E9B0C9FF516539EEDBE64EC22C281D9CCA823F0EF008BD093364173E28D634A3A795C9DED7F54220E61DF426D350FEEBCEF99C5D40A917832EB8E5EB4F01C33C2A4309DF256779ED0602747EB3B135F75EE397EF4CB68BA0A4E62DE8F3B677F947D0015319BBC7152BFD3D69AF27216D1B14107E59DA90886386B91ECB38052FC416A0FAE24C213CED616BC718EA3D148299A2BFE51734C1F6D4D5FE57988888182A1E5713E6F967CD065496923DDC511E386A69C6DC600A39A5BB5715C57649AF67985F54B3F4116A8EC76E20DB55D624FF88989F97888219CDD254CC9578D627B3C22918CF3781B3FA61C7711FF3B0CA3E42E6F92C9DDDD109AFD1AB5F56638D847073A5A2F11877E9103B278F45B871DF08157210B0CC9445CD8A0319C12CF1495EA74AC01D4490D0339022570852158FDDC55FB367EF10D383D68859EE832B613EDDDF1566531835841A56F4CD1645054793AAFE1DE7CEFCA6EDECBD73376DAD979628E7CDF975DF1FCEBF8904CF79CE10D0661BC3FAD25455AE21BDD71298E9376562EC417C55A4CFAF14CADFA65AA53E09EF063EBE8F74F0C3297A75CD7E9924B1F039795B37AD10F6802D60364841CB1AC31591A3843F4286A870D2E5B8753287BCFCFA8DC4DEB754D6E9855DF442942B63F15416A7A52547BF2C9EA754914853642F793F62B7ECF94A59DDAB97B1A3B3BD19F49F1F1A84DE0E381AF4216B6EB466159F17BE10D32E8873B4C30ADC1022CAAE324B4B3254850A99E9CEC07C21940279AF6E7C5899E20734AC7C36A36F4C51C653209A1E367877B546C02F659C8B6F7302EA7C72997F440C5EA2A17CDA3B929E2C3804AAC75BD63992E77B9E213AB7FDE549E9F348592E3FF01F24C3C6B6FA5D61C68B045D21EC425BF11965D12469ECDB71740509B03DBF21A6972B7C816ADC03CCCA03E1ECEED97909B48828B812D1A69C3F1E493144C42230B06910F440D073018B9A4C51B8EDD7E3332411FDF8D1B864F91A64668DA1B213E7125E885F2DE8DD911BCF18994013C21FDA2D5EA6937AEFD16799479FE1B7AD884FE02BF6BAA9AFA15CCBE5B7A5071ECEF98245D0F58A8C28DD1C7701784F68C9CC5F197C3D8B75C11C242E899528ADCACDCEDF83AB0FB28FC2D90FC054C1D0B35BAA55EBA725BCD9BE6C1A2B1F3F21A7C5F857BD1475E9F5A57EE4465D7A164D5AD4644B73E9367274B592F23B714D5F7470B0519C7432A3A5E7C92EAC24491898C0DC41F373D0680BAB17A17EAC7E84954186527D250D8292CBF261EEC3CFF8187E798932D0014A3D7E3E678AAE7C90B50BE18A2A53C94FEB0E83C678E3C30BE0309512B9F1F575DDFC8B3DBF3349580E4721624FEFCD31FDB860B0478BDCF7965540140E42F4D80E49CBBFFB4CB0CBE3BCB04C30F29A9552B2228F749AEFBBD38B8F00C98BE87849FF70FA9574E2BB110605B8033D8562AA46CF26C2E6AB6074B52CDC84C288B6FBCB078B883F06324F026812DC96A557832B390348351898B002C6CE81219F5382ACB100FC843AEFA89E5155CEABBABF1B61D82E089CFB2BBF570ACE7A299AD40F958D93B5CE6CC734B3FADD4843BA4DD117FB1874841454E971B1B488E0CEF46597775F51AC45B34DF9B1B4C701896F6FB2077840D3B2C29298F3C7E91FD000E38DA5F80736BB8DEEAA593500B2FCDB4F5A9EB6E1E7B31D3F4E8497603EC4D79D0E1D14273326BC23876A1480C065DC835AC1095A85CAA30A20BFB60BD4EC65EB589819E68F8059C0C7ECD8D0CEA77E5321D3F0FD03D0BE3CA43147F16C29D63733097530639844A5B9840D26D972D10F229EFBB7288FE7B4B32C81D9ADB7AF7541C1E7D2CC129A962B6CE227A500FC397738870934897558182E069EC2D9C893EEBAC9C6656BF008401F387E0439C8AA4D31DEEA44CDDFCA1CBD070A795B2DD10DE3F4E5EDE4F05DBC419FB5907C1CAA6F41715BE01F346A056CF57EFE4472632786CD9453305D0E3360962FF73BEA8D34C834B8B2D8AB48030FAA074640DB7CFA404DB1D4".to_string()).unwrap();
        let test_data: Value = serde_json::from_str(TEST_DATA).unwrap();
        assert_eq!(data, test_data);
    }
}
